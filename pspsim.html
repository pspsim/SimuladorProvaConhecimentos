<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Simulador PSP</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  h1 { text-align: center; }
  .question { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
  .options { margin-top: 10px; }
  .options label { display: block; margin-bottom: 5px; }
  #timer { font-size: 20px; font-weight: bold; text-align: center; margin-bottom: 20px; }
  #submit { display: block; margin: 0 auto; padding: 10px 20px; font-size: 16px; }
  #result { margin-top: 20px; font-size: 18px; font-weight: bold; text-align: center; }
</style>
</head>
<body>
<header style="
    background-color: #003366;
    color: white;
    font-family: Arial, Helvetica, sans-serif;
    position: relative;
    height: 140px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    overflow: hidden;
">
    <div style="font-size: 2.8rem; letter-spacing: 1px; text-transform: uppercase; z-index: 2;">SIMULADOR PSP</div>
    <div style="
        font-size: 1.05rem;
        font-style: italic;
        margin-top: 8px;
        text-align: center;
        max-width: 90%;
        z-index: 2;
    ">
        Simulação da Prova de Conhecimentos da Polícia de Segurança Pública
    </div>

    <!-- 5 alternating stripes starting with background color at bottom-right corner -->
    <div style="
        position: absolute;
        bottom: 0;
        right: 0;
        width: 140px;
        height: 100%;
    ">
        <!-- Stripe 1: background color (dark blue), 10px -->
        <div style="
            position: absolute;
            width: 10px;
            height: 180%;
            background: #003366;
            transform: rotate(45deg);
            transform-origin: bottom right;
            right: 10px;
            bottom: -40%;
            opacity: 1;
        "></div>

        <!-- Stripe 2: white, 10px -->
        <div style="
            position: absolute;
            width: 10px;
            height: 180%;
            background: white;
            transform: rotate(45deg);
            transform-origin: bottom right;
            right: 30px;
            bottom: -40%;
            opacity: 0.8;
        "></div>

        <!-- Stripe 3: background color, 10px -->
        <div style="
            position: absolute;
            width: 10px;
            height: 180%;
            background: #003366;
            transform: rotate(45deg);
            transform-origin: bottom right;
            right: 50px;
            bottom: -40%;
            opacity: 1;
        "></div>

        <!-- Stripe 4: white, 10px -->
        <div style="
            position: absolute;
            width: 10px;
            height: 180%;
            background: white;
            transform: rotate(45deg);
            transform-origin: bottom right;
            right: 70px;
            bottom: -40%;
            opacity: 0.8;
        "></div>

        <!-- Stripe 5: background color, 10px -->
        <div style="
            position: absolute;
            width: 10px;
            height: 180%;
            background: #003366;
            transform: rotate(45deg);
            transform-origin: bottom right;
            right: 90px;
            bottom: -40%;
            opacity: 1;
        "></div>
    </div>
</header>

<div id="timer">02:00:00</div>
<form id="quizForm"></form>
<button id="submit">Submeter Teste</button>
<div id="result"></div>

<script>
// ======== CONFIGURAÇÃO DAS PERGUNTAS ========
// Cada pergunta tem: texto, 4 opções (A,B,C,D) e a letra da correta
const questions = [
  {
    question: "1. Qual é a capital de Portugal?",
    options: ["Porto", "Lisboa", "Coimbra", "Todas as anteriores"],
    answer: "B"
  },
  {
    question: "2. Qual é o maior rio de Portugal?",
    options: ["Tejo", "Douro", "Guadiana", "Todas as anteriores"],
    answer: "A"
  },
  {
    question: "3. A Constituição Portuguesa prevê o direito de resistência?",
    options: ["Sim, mas apenas contra sujeitos privados", "Sim, contra poderes públicos e privados", "Não", "Todas as anteriores"],
    answer: "B"
  }
  // Adiciona mais perguntas aqui...
];

// ======== FUNÇÃO PARA EMBARALHAR ARRAYS ========
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// ======== CRIAR FORMULÁRIO ========
const quizForm = document.getElementById("quizForm");

questions.forEach((q, idx) => {
  const div = document.createElement("div");
  div.className = "question";

  const qText = document.createElement("div");
  qText.textContent = q.question;
  div.appendChild(qText);

  const opts = [...q.options];
  const todasIndex = opts.findIndex(opt => opt.startsWith("Todas"));
  if (todasIndex !== -1) {
    const todas = opts.splice(todasIndex, 1)[0];
    shuffleArray(opts);
    opts.push(todas); // "Todas" sempre na última posição
  } else {
    shuffleArray(opts);
  }

  const optionsDiv = document.createElement("div");
  optionsDiv.className = "options";

  opts.forEach((opt, i) => {
    const label = document.createElement("label");
    const radio = document.createElement("input");
    radio.type = "radio";
    radio.name = "q" + idx;
    radio.value = String.fromCharCode(65 + i); // A, B, C, D
    label.appendChild(radio);
    label.appendChild(document.createTextNode(" " + opt));
    optionsDiv.appendChild(label);
  });

  div.appendChild(optionsDiv);
  quizForm.appendChild(div);
});

// ======== TIMER ========
let time = 2 * 60 * 60; // 2 horas em segundos
const timerDiv = document.getElementById("timer");

function updateTimer() {
  const h = String(Math.floor(time / 3600)).padStart(2, '0');
  const m = String(Math.floor((time % 3600) / 60)).padStart(2, '0');
  const s = String(time % 60).padStart(2, '0');
  timerDiv.textContent = `${h}:${m}:${s}`;
  if (time <= 0) {
    clearInterval(timerInterval);
    submitTest();
  }
  time--;
}

const timerInterval = setInterval(updateTimer, 1000);

// ======== CALCULAR NOTA ========
function submitTest() {
  let score = 0;
  questions.forEach((q, idx) => {
    const selected = document.querySelector(`input[name="q${idx}"].checked`);
    if (selected && selected.value === q.answer) {
      score++;
    }
  });
  const finalScore = (score / questions.length) * 20;
  document.getElementById("result").textContent = 
    `Acertaste ${score}/${questions.length} perguntas. Nota final: ${finalScore.toFixed(2)}/20`;
}

document.getElementById("submit").addEventListener("click", function(e) {
  e.preventDefault();
  clearInterval(timerInterval);
  submitTest();
});
</script>

</body>
</html>